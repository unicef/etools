# -*- coding: utf-8 -*-
# Generated by Django 1.9.10 on 2017-04-25 15:09
from __future__ import unicode_literals

from django.db import migrations


def migrate_location_name_to_fk(apps, schema_editor):
    Location = apps.get_model("locations", "Location")
    IteneraryItem = apps.get_model("t2f", "IteneraryItem")
    for item in IteneraryItem.objects.all():
        location_origin = Location.objects.filter(name__iexact=item.origin.lower())
        if location_origin.exists():
            item.origin_fk = location_origin.first()
            print(u"SUCCESS: Origin location set for IteneraryItem: {}".format(item.id))
        else:
            print(u"FAIL: Origin location not found for IteneraryItem: {}".format(item.id))
        location_destination = Location.objects.filter(name__iexact=item.destination.lower())
        if location_destination.exists():
            item.destination_fk = location_destination.first()
            print(u"SUCCESS: Destination location set for IteneraryItem: {}".format(item.id))
        else:
            print(u"FAIL: Destination location not found for IteneraryItem: {}".format(item.id))
        item.save()

def reverse(apps, schema_editor):
    pass


class Migration(migrations.Migration):

    dependencies = [
        ('t2f', '0011_auto_20170425_1508'),
    ]

    operations = [
        migrations.RunPython(migrate_location_name_to_fk, reverse),
    ]
