{% extends "base.html" %}
{% load leaflet_tags %}

{% block extra_head %}
    <!-- DataTables-->
    <link rel="stylesheet" href="http://libs.cartocdn.com/cartodb.js/v3/3.11/themes/css/cartodb.css"/>
    <link rel="stylesheet" href="{{ STATIC_URL }}plugins/dataTables/css/dataTables.css">

{% endblock %}

{% block content %}
    <section class="main-content-wrapper">
        <section id="main-content">

            <!--tiles start-->
            <div class="row">
                <div class="col-md-3 col-sm-6">
                    <div class="dashboard-tile detail tile-red">
                        <div class="content">
                            <h1 class="text-left timer"
                                data-from="0"
                                data-to="{{ distributions }}"
                                data-speed="2500"></h1>

                            <p>Distributions Planned</p>
                        </div>
                        <div class="icon"><i class="fa fa-pencil"></i>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="dashboard-tile detail tile-turquoise">
                        <div class="content">
                            <h1 class="text-left timer"
                                data-from="0"
                                data-to="{{ completed }}"
                                data-speed="2500"></h1>

                            <p>Distributions Completed</p>
                        </div>
                        <div class="icon"><i class="fa fa-thumbs-up"></i>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="dashboard-tile detail tile-purple">
                        <div class="content">
                            <h1 class="text-left timer"
                                data-from="0"
                                data-to="{{ supplies_planned }}"
                                data-speed="2500"></h1>

                            <p>Supplies Planned</p>
                        </div>
                        <div class="icon"><i class="fa fa-gift"></i>
                        </div>
                    </div>
                </div>
                <div class="col-md-3 col-sm-6">
                    <div class="dashboard-tile detail tile-blue">
                        <div class="content">
                            <h1 class="text-left timer"
                                data-from="0"
                                data-to="{{ supplies_delivered }}"
                                data-speed="2500"></h1>

                            <p>Supplies Delivered</p>
                        </div>
                        <div class="icon"><i class="fa fa-gift"></i>
                        </div>
                    </div>
                </div>
            </div>
            <!--tiles end-->

            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-body">
                            <iframe width="100%" height="520" frameborder="0"
                                    src="https://equitrack.cartodb.com/viz/d15efba2-6685-11e4-8061-0e853d047bba/embed_map"
                                    allowfullscreen webkitallowfullscreen mozallowfullscreen oallowfullscreen msallowfullscreen>
                            </iframe>
                        </div>
                    </div>
                </div>
            </div>

            <div class="row">
                <div class="col-md-12">
                    <div class="panel panel-default">
                        <div class="panel-heading">
                            <h3 class="panel-title">Kits by PCode</h3>

                            <div class="actions pull-right">
                                <i class="fa fa-chevron-down"></i>
                                <i class="fa fa-times"></i>
                            </div>
                        </div>
                        <div class="panel-body">
                            <table id="kits" class="table table-striped table-bordered" cellspacing="0" width="100%">
                                <thead>
                                <tr>
                                    <th>_id</th>
                                    <th>p_code</th>
                                    <th>p_code_name</th>
                                    <th>phone_number</th>
                                    <th>latitude</th>
                                    <th>longitude</th>
                                    <th>first_name</th>
                                    <th>middle_name</th>
                                    <th>last_name</th>
                                    <th>official_id</th>
                                    <th>id_type</th>
                                    <th>gender</th>
                                    <th>marital_status</th>
                                    <th>dob</th>
                                    <th>creation_date</th>
                                    <th>partner_name</th>
                                    <th>Do you have school-aged children not attending school?</th>
                                    <th>Do you have school aged children working</th>
                                    <th>Is the principle applicant still present?</th>
                                    <th>Will the family move in the near future?</th>
                                    <th>new_location</th>
                                    <th>Under 4 months</th>
                                    <th>Under 24 months</th>
                                    <th>2 years</th>
                                    <th>3 years</th>
                                    <th>4 years</th>
                                    <th>5 years</th>
                                    <th>6 years</th>
                                    <th>7 years</th>
                                    <th>8 years</th>
                                    <th>9 years</th>
                                    <th>10 years</th>
                                    <th>11 years</th>
                                    <th>12 years</th>
                                    <th>13 years</th>
                                    <th>14 years</th>
                                    <th>CSC Survey Q1 - Did you recieve the CSC card?</th>
                                    <th>CSC Survey Q2 - Do you still have the CSC card?</th>
                                    <th>CSC Survey Q3 - Do you remember the PIN number?</th>
                                    <th>CSC Survey Q4 - Please enter the last four digits of the card</th>
                                    <th>CSC Survey Q5 - Is the case number written on the card equal to the one in the registration certificate?</th>
                                    <th>CSC Survey Q6 - Reasons for not having the card</th>
                                    <th>CSC Survey Q7 - Did you inform UNHCR or the Bank?</th>
                                    <th>CSC Survey Q8 - Did UNHCR issue a new PIN number?</th>
                                    <th>CSC Survey Q9 - Input number of actual card</th>
                                    <th>CSC Survey Q10 - Did you inform UNHCR or the Bank?</th>
                                    <th>WFP Survey Q1 - Did you recieve a WFP Food voucher card?</th>
                                    <th>WFP Survey Q2 - Do you still have the WFP voucher card?</th>
                                    <th>WFP Survey Q3 - Please input the last 4 digits of the WFP card</th>
                                    <th>WFP Survey Q4 - Does the case number correspond to the WFP card?</th>
                                    <th>WFP Survey Q5 - Did your WFP voucher Card get upgraded to an ATM Card?</th>
                                    <th>WFP Survey Q6 - Do you still have the PIN number?</th>
                                    <th>WFP Survey Q7 - Is the card still functioning/activated?</th>
                                    <th>WFP Survey Q8 - Reasons for not having the WFP card</th>
                                    <th>WFP Survey Q9 - Did you notify the partner/bank?</th>
                                    <th>WFP Survey Q10 - Take down the card number</th>
                                    <th>WFP Survey Q11 - Did you inform the bank?</th>
                                </tr>
                                </thead>
                                <tbody>
                                </tbody>
                            </table>
                        </div>
                    </div>
                </div>
            </div>
            <div class="row">
{#                <div class="col-md-6">#}
{#                    <a href="{% url 'winter_app' %}">#}
{#                        <button type="button" class="btn btn-success btn-trans">#}
{#                            Download App#}
{#                        </button>#}
{#                    </a>#}
{#                </div>#}
                <div class="col-md-6">
                    <a href="{% url 'winter_site_list' %}?format=csv">
                        <button style="float: right;" type="button" class="btn btn-info btn-trans">
                            Download Data
                        </button>
                    </a>
                </div>
            </div>

        </section>
    </section>
{% endblock %}

{% block extra_js %}
    <script src="//libs.cartocdn.com/cartodb.js/v3/3.11/cartodb.js"></script>
    <script src="{{ STATIC_URL }}plugins/dataTables/js/jquery.dataTables.js"></script>
    <script src="{{ STATIC_URL }}plugins/dataTables/js/dataTables.bootstrap.js"></script>
        <script src="//cdn.datatables.net/tabletools/2.2.3/js/dataTables.tableTools.min.js"></script>
    <script>
        $(document).ready(function () {
            $('#kits').dataTable({
                                "dom": 'T<"clear">lfrtip',
                                "tableTools": {
                                    "sSwfPath": "//cdn.datatables.net/tabletools/2.2.3/swf/copy_csv_xls_pdf.swf"
                                },
                "scrollX": true,
                //"processing": true,
                //"serverSide": true,
                "ajax": "{% url 'winter_site_list' %}"
            });

            cartodb.createVis(
                    'map',
                    'http://equitrack.cartodb.com/api/v2/viz/d15efba2-6685-11e4-8061-0e853d047bba/viz.json'
            );
        });


    </script>

{% endblock %}