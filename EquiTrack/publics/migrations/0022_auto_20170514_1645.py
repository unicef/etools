# -*- coding: utf-8 -*-
# Generated by Django 1.9.10 on 2017-05-14 16:45
from __future__ import unicode_literals

from django.db import migrations, models
from django.core.exceptions import ObjectDoesNotExist
from django.db.models.manager import Manager


dsa_code_iso_mapping = [
    ('AFG', 'AFG'),
    ('ALB', 'ALB'),
    ('ALG', 'DZA'),
    ('ARG', 'ARG'),
    ('ARM', 'ARM'),
    ('AZE', 'AZE'),
    ('ANL', 'AIA'),
    ('ANT', 'ATG'),
    ('BAR', 'BRB'),
    ('BVI', 'VGB'),
    ('DMI', 'DMA'),
    ('GRN', 'GRD'),
    ('MOT', 'MSR'),
    ('STK', 'KNA'),
    ('STL', 'LCA'),
    ('STV', 'VCT'),
    ('TCI', 'TCA'),
    ('TRI', 'TTO'),
    ('BHU', 'BTN'),
    ('BOL', 'BOL'),
    ('BOT', 'BWA'),
    ('BIH', 'BIH'),
    ('BRA', 'BRA'),
    ('BUL', 'BGR'),
    ('MYA', 'MMR'),
    ('BDI', 'BDI'),
    ('BYE', 'BLR'),
    ('CMB', 'KHM'),
    ('CMR', 'CMR'),
    ('CAF', 'CAF'),
    ('SRL', 'LKA'),
    ('CHD', 'TCD'),
    ('CHI', 'CHL'),
    ('CPR', 'CHN'),
    ('COL', 'COL'),
    ('ZAI', 'COD'),
    ('COS', 'CRI'),
    ('CRO', 'HRV'),
    ('CUB', 'CUB'),
    ('BEN', 'BEN'),
    ('DEN', 'DNK'),
    ('DOM', 'DOM'),
    ('ECU', 'ECU'),
    ('ELS', 'SLV'),
    ('EQG', 'GNQ'),
    ('ETH', 'ETH'),
    ('ERI', 'ERI'),
    ('AMS', 'ASM'),
    ('CKI', 'COK'),
    ('FIJ', 'FJI'),
    ('KIR', 'KIR'),
    ('MAS', 'MHL'),
    ('MIC', 'FSM'),
    ('NAU', 'NRU'),
    ('NIU', 'NIU'),
    ('PAL', 'PLW'),
    ('SAM', 'WSM'),
    ('SOI', 'SLB'),
    ('TOK', 'TKL'),
    ('TON', 'TON'),
    ('TUV', 'TUV'),
    ('VAN', 'VUT'),
    ('GAB', 'GAB'),
    ('GAM', 'GMB'),
    ('GEO', 'GEO'),
    ('GHA', 'GHA'),
    ('GUA', 'GTM'),
    ('GUI', 'GIN'),
    ('GUY', 'GUY'),
    ('SUR', 'SUR'),
    ('HAI', 'HTI'),
    ('HON', 'HND'),
    ('IND', 'IND'),
    ('INS', 'IDN'),
    ('IRA', 'IRN'),
    ('IRQ', 'IRQ'),
    ('IVC', 'CIV'),
    ('JAM', 'JAM'),
    ('JOR', 'JOR'),
    ('KAZ', 'KAZ'),
    ('KEN', 'KEN'),
    ('KYR', 'KGZ'),
    ('LAO', 'LAO'),
    ('LEB', 'LBN'),
    ('LES', 'LSO'),
    ('LIR', 'LBR'),
    ('LIB', 'LBY'),
    ('MCD', 'MKD'),
    ('MAG', 'MDG'),
    ('MLW', 'MWI'),
    ('MAL', 'MYS'),
    ('MDV', 'MDV'),
    ('MLI', 'MLI'),
    ('MAU', 'MRT'),
    ('MEX', 'MEX'),
    ('MON', 'MNG'),
    ('MOR', 'MAR'),
    ('NEP', 'NPL'),
    ('NIC', 'NIC'),
    ('NER', 'NER'),
    ('NIR', 'NGA'),
    ('PAK', 'PAK'),
    ('PAN', 'PAN'),
    ('PAR', 'PRY'),
    ('PRC', 'COG'),
    ('PER', 'PER'),
    ('PHI', 'PHL'),
    ('ROM', 'ROU'),
    ('RUS', 'RUS'),
    ('RWA', 'RWA'),
    ('BAH', 'BHR'),
    ('KUW', 'KWT'),
    ('QAT', 'QAT'),
    ('SAU', 'SAU'),
    ('UAE', 'ARE'),
    ('SEN', 'SEN'),
    ('SIL', 'SLE'),
    ('SOM', 'SOM'),
    ('SAF', 'ZAF'),
    ('SUD', 'SDN'),
    ('SWA', 'SWZ'),
    ('SSD', 'SSD'),
    ('SYR', 'SYR'),
    ('TAJ', 'TJK'),
    ('THA', 'THA'),
    ('TOG', 'TGO'),
    ('TUN', 'TUN'),
    ('TUR', 'TUR'),
    ('TUK', 'TKM'),
    ('UGA', 'UGA'),
    ('UKR', 'UKR'),
    ('EGY', 'EGY'),
    ('URT', 'TZA'),
    ('BKF', 'BFA'),
    ('URU', 'URY'),
    ('UZB', 'UZB'),
    ('VEN', 'VEN'),
    ('YEM', 'YEM'),
    ('ZAM', 'ZMB'),
    ('BGD', 'BGD'),
    ('DRK', 'PRK'),
    ('VIE', 'VNM'),
    ('MOL', 'MDA'),
    ('SWI', 'CHE'),
    ('BZE', 'BLZ'),
    ('ZIM', 'ZWE'),
    ('OMA', 'OMN'),
    ('PNG', 'PNG'),
    ('COI', 'COM'),
    ('DJI', 'DJI'),
    ('ANG', 'AGO'),
    ('CVI', 'CPV'),
    ('STP', 'STP'),
    ('GBS', 'GNB'),
    ('MOZ', 'MOZ'),
    ('NAM', 'NAM'),
    ('OCT', 'PSE'),
    ('TIM', 'TLS'),
    ('MNE', 'MNE'),
    ('SRB', 'SRB'),
    ('ARU', 'ABW'),
    ('AUL', 'AUS'),
    ('AUS', 'AUT'),
    ('BEL', 'BEL'),
    ('BER', 'BMU'),
    ('BHA', 'BHS'),
    ('BRU', 'BRN'),
    ('CAN', 'CAN'),
    ('CAY', 'CYM'),
    ('CEH', 'CZE'),
    ('CYP', 'CYP'),
    ('EST', 'EST'),
    ('FIN', 'FIN'),
    ('FRA', 'FRA'),
    ('GER', 'DEU'),
    ('GIB', 'GIB'),
    ('GRE', 'GRC'),
    ('GUM', 'GUM'),
    ('HOK', 'HKG'),
    ('HUN', 'HUN'),
    ('ICE', 'ISL'),
    ('IRE', 'IRL'),
    ('ISR', 'ISR'),
    ('ITA', 'ITA'),
    ('JPN', 'JPN'),
    ('LAT', 'LVA'),
    ('LIT', 'LTU'),
    ('LUX', 'LUX'),
    ('MAC', 'MAC'),
    ('MAR', 'MUS'),
    ('MAT', 'MLT'),
    ('MNC', 'MCO'),
    ('NCA', 'NCL'),
    ('NET', 'NLD'),
    ('NOR', 'NOR'),
    ('NZE', 'NZL'),
    ('POL', 'POL'),
    ('POR', 'PRT'),
    ('PUE', 'PRI'),
    ('ROK', 'KOR'),
    ('SAH', 'ESH'),
    ('SEY', 'SYC'),
    ('SIN', 'SGP'),
    ('SLO', 'SVK'),
    ('SPA', 'ESP'),
    ('SVN', 'SVN'),
    ('SWE', 'SWE'),
    ('GB', 'GBP'),
    ('USA', 'USA'),
    ('UVI', 'VIR')
]

def insert_dsa_codes(apps, schema_editor):
    Country = apps.get_model('publics', 'Country')
    for dsa_code, iso_code in dsa_code_iso_mapping:
        try:
            country = Country.objects.get(iso_3=iso_code)
        except ObjectDoesNotExist as e:
            print(e.message)
        else:
            country.dsa_code = dsa_code


class Migration(migrations.Migration):

    dependencies = [
        ('publics', '0021_dsarateupload'),
    ]

    operations = [
        migrations.AddField(
            model_name='country',
            name='dsa_code',
            field=models.CharField(max_length=3, null=True),
        ),
        # There's an issue without this: AttributeError: type object 'Country' has no attribute 'objects'
        # https://github.com/django-mptt/django-mptt/issues/489#issuecomment-251929575
        migrations.AlterModelManagers(
            name='country',
            managers=[],
        ),
        migrations.RunPython(insert_dsa_codes)
    ]
